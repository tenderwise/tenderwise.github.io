(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[717],{1717:(e,t,r)=>{"use strict";r.d(t,{a:()=>q,qh:()=>Q,av:()=>z});var a=r(94971),s=r(95920),n=r(86266),i=r(23464),o=r(45009),l=r.n(o),c=r(48973),u=r.n(c);let d="AUTH_TOKEN";var h=new WeakMap,_=new WeakMap,p=new WeakMap,v=new WeakMap;class m{constructor(e){var t=this;(0,s._)(this,h,{writable:!0,value:void 0}),(0,s._)(this,_,{writable:!0,value:void 0}),(0,s._)(this,p,{writable:!0,value:void 0}),(0,s._)(this,v,{writable:!0,value:void 0}),(0,n._)(this,h,"@".concat("TENDERWISE",":API")),(0,n._)(this,p,""),(0,n._)(this,v,!0),this.getAuthToken=()=>{if((0,a._)(this,v)&&"undefined"!=typeof localStorage)try{let e=JSON.parse(localStorage.getItem(d)||"{}"),t=u()(e,"token");(0,n._)(this,p,t)}catch(e){}return(0,a._)(this,p)?"Bearer ".concat((0,a._)(this,p)):""},this.setAuthToken=e=>{(0,n._)(this,p,e),(0,a._)(this,v)&&"undefined"!=typeof localStorage&&localStorage.setItem(d,JSON.stringify({token:e}))},this.clearAuthToken=()=>{(0,n._)(this,p,""),(0,a._)(this,v)&&"undefined"!=typeof localStorage&&localStorage.removeItem(d)},this.createAxiosInstance=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{baseUrl:""},{baseUrl:r,requestInterceptor:a,responseInterceptor:s,responseErrorInterceptor:o,authToken:l}=e,c=i.A.create({baseURL:r});return l&&(0,n._)(t,p,l),a&&c.interceptors.request.use(async e=>(a&&await a(e),Promise.resolve(e))),(s||o)&&c.interceptors.response.use(async e=>(s&&await s(e),e),async e=>(o&&await o(e),Promise.reject(e))),c},this.get=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t.getAuthToken())throw Error("[".concat((0,a._)(t,h),"]: Auth token is not set, use anonGet method for anonymous get calls"));return l()(r,'headers["Authorization"]',t.getAuthToken()),(0,a._)(t,_).get(e,r)},this.post=function(e,r){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.getAuthToken())throw Error("[".concat((0,a._)(t,h),"]: Auth token is not set, use anonPost method for anonymous post calls"));return l()(s,'headers["Authorization"]',t.getAuthToken()),(0,a._)(t,_).post(e,r,s)},this.put=function(e,r){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.getAuthToken())throw Error("[".concat((0,a._)(t,h),"]: Auth token is not set, use anonPut method for anonymous put calls"));return l()(s,'headers["Authorization"]',t.getAuthToken()),(0,a._)(t,_).put(e,r,s)},this.delete=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t.getAuthToken())throw Error("[".concat((0,a._)(t,h),"]: Auth token is not set, use anonDelete method for anonymous delete calls"));return l()(r,'headers["Authorization"]',t.getAuthToken()),(0,a._)(t,_).delete(e,r)},this.patch=function(e,r){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.getAuthToken())throw Error("[".concat((0,a._)(t,h),"]: Auth token is not set, use anonPatch for anonymous patch calls"));return l()(s,'headers["Authorization"]',t.getAuthToken()),(0,a._)(t,_).patch(e,r,s)},this.anonGet=(e,t)=>(0,a._)(this,_).get(e,t),this.anonPost=(e,t,r)=>(0,a._)(this,_).post(e,t,r),this.anonPut=(e,t,r)=>(0,a._)(this,_).put(e,t,r),this.anonDelete=(e,t)=>(0,a._)(this,_).delete(e,t),this.anonPatch=(e,t,r)=>(0,a._)(this,_).patch(e,t,r),this.mockCall=function(){let{data:e,delayInMs:t=2e3}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(r=>{setTimeout(()=>{r(e||null)},t)})},(0,n._)(this,_,this.createAxiosInstance(e)),this.getAuthToken()}}var g=r(10649),f=r(38771),y=r(658),w=r(39285),A=r(63179),b=r(54076),k=r(31957);let S="AUTH_TOKEN";var I=new WeakMap,x=new WeakMap,N=new WeakMap,T=new WeakMap;class E{constructor(e){(0,s._)(this,I,{writable:!0,value:void 0}),(0,s._)(this,x,{writable:!0,value:void 0}),(0,s._)(this,N,{writable:!0,value:void 0}),(0,s._)(this,T,{writable:!0,value:void 0}),(0,n._)(this,I,"@".concat("TENDERWISE",":GQL")),(0,n._)(this,N,""),(0,n._)(this,T,!0),this.getAuthToken=()=>{if((0,a._)(this,T)&&"undefined"!=typeof localStorage)try{let e=JSON.parse(localStorage.getItem(S)||"{}").token||"";(0,n._)(this,N,e)}catch(e){}return(0,a._)(this,N)?"Bearer ".concat((0,a._)(this,N)):""},this.setAuthToken=e=>{(0,n._)(this,N,e),(0,a._)(this,T)&&"undefined"!=typeof localStorage&&localStorage.setItem(S,JSON.stringify({token:e}))},this.clearAuthToken=()=>{(0,n._)(this,N,""),(0,a._)(this,T)&&"undefined"!=typeof localStorage&&localStorage.removeItem(S)},this.createApolloClient=e=>{let{uri:t,authToken:r,enableCache:s=!0,defaultFetchPolicy:i="cache-and-network",requestInterceptor:o,responseInterceptor:l,responseErrorInterceptor:c}=e;r&&(0,n._)(this,N,r);let u=new g.P({uri:t}),d=new b.m((e,t)=>{let r=this.getAuthToken();return o&&o({query:t.query,variables:t.variables,context:{}}).catch(e=>{console.error("[".concat((0,a._)(this,I),"]: Request interceptor error"),e)}),{...e,headers:{...e.headers||{},authorization:r||""}}}),h=new k.L(e=>{let{graphQLErrors:t,networkError:r,operation:s}=e;if(t&&t.forEach(e=>{console.error("[".concat((0,a._)(this,I),"]: GraphQL error:"),{message:e.message,locations:e.locations,path:e.path,extensions:e.extensions,operation:s.operationName})}),r&&console.error("[".concat((0,a._)(this,I),"]: Network error:"),r),c&&(t||r)){var n;c(r||Error((null==t||null==(n=t[0])?void 0:n.message)||"GraphQL Error")).catch(e=>{console.error("[".concat((0,a._)(this,I),"]: Error interceptor failed"),e)})}}),_=new f.C((e,t)=>{console.log("[".concat((0,a._)(this,I),"]: Operation:"),{name:e.operationName,variables:e.variables});let r=t(e);return new y.c(e=>{let t=r.subscribe({next:t=>{l&&l(t).catch(e=>{console.error("[".concat((0,a._)(this,I),"]: Response interceptor error"),e)}),e.next(t)},error:t=>e.error(t),complete:()=>e.complete()});return()=>{t&&t.unsubscribe()}})}),p=f.C.from([h,_,d,u]);return new w.R({link:p,cache:new A.D(s?{resultCaching:!0}:{resultCaching:!1}),defaultOptions:{watchQuery:{fetchPolicy:i,errorPolicy:"all"},query:{fetchPolicy:i,errorPolicy:"all"},mutate:{errorPolicy:"all"}}})},this.query=async(e,t)=>{try{return await (0,a._)(this,x).query({query:e,variables:null==t?void 0:t.variables,fetchPolicy:null==t?void 0:t.fetchPolicy,context:null==t?void 0:t.context})}catch(e){throw console.error("[".concat((0,a._)(this,I),"]: Query error"),e),e}},this.mutate=async(e,t)=>{try{return await (0,a._)(this,x).mutate({mutation:e,variables:null==t?void 0:t.variables,context:null==t?void 0:t.context,refetchQueries:null==t?void 0:t.refetchQueries,awaitRefetchQueries:null==t?void 0:t.awaitRefetchQueries})}catch(e){throw console.error("[".concat((0,a._)(this,I),"]: Mutation error"),e),e}},this.getClient=()=>(0,a._)(this,x),this.clearCache=async()=>{await (0,a._)(this,x).clearStore()},this.resetStore=async()=>{await (0,a._)(this,x).resetStore()},(0,n._)(this,x,this.createApolloClient(e)),this.getAuthToken()}}r(44377),r(30816);var P=r(8979),C=new WeakMap,j=new WeakMap;class O{constructor(e){(0,s._)(this,C,{writable:!0,value:void 0}),(0,s._)(this,j,{writable:!0,value:void 0}),this.uploadDocument=e=>{let{file:t,tenderId:r,uploadCategory:s}=e,n=new FormData;return n.append("tender_id",r),n.append("user_id",(0,a._)(this,j).getUserId()||""),n.append("upload_category",s),n.append("file",t),(0,a._)(this,C).post("/documents/upload_document",n)},(0,n._)(this,C,e.apiService),(0,n._)(this,j,e.authenticationService)}}r(12115);var U=r(51990);let R=(0,U.Z0)({name:"TAG",initialState:{tags:[]},reducers:{addTags:(e,t)=>{let{tags:r,replaceData:a,replaceList:s}=t.payload;e.tags=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{replaceData:a,replaceList:s,itemIdKey:n="id",oldNewItemCombineFunction:i}=r;return s?t:(t.forEach(t=>{let r=t[n],s=e.findIndex(e=>e.id===r);if(-1===s)e.unshift(t);else if(a)e[s]=t,e=[...e];else{let r=e[s],a=i?i(r,t):{...r,...t};e[s]=a}}),e)}(e.tags,r,{replaceData:a,replaceList:s})},removeTags:(e,t)=>{var r;let{idList:a}=t.payload;r=e.tags,e.tags=r.filter(e=>!a.includes(e.id))}}}),D=R.actions,L=R.reducer,B=(0,U.U1)({reducer:{tag:L},middleware:e=>e()});var M=new WeakMap,F=new WeakMap;class W{constructor(e){(0,s._)(this,M,{writable:!0,value:void 0}),(0,s._)(this,F,{writable:!0,value:void 0}),this.fetchTagByIds=e=>{let{tagIds:t}=e;return(0,a._)(this,M).post("/tags/by_id",{tag_ids:t,user_id:(0,a._)(this,F).getUserId()}).then(e=>{let t=e.data;return B.dispatch(D.addTags({tags:t})),{tags:t}})},this.fetchTags=e=>{let{type:t,parentId:r}=e;return(0,a._)(this,M).post("/tags",{type:t,user_id:(0,a._)(this,F).getUserId(),parent_id:r}).then(e=>{let t=e.data.data;return B.dispatch(D.addTags({tags:t})),{tags:t}})},this.addTag=e=>{let{tag:t}=e;return(0,a._)(this,M).post("/tags/insert_or_update",{...t,tag:"static_data"}).then(e=>e.data)},this.updateTag=e=>{let{tag:t}=e;return(0,a._)(this,M).post("/tags/insert_or_update",t)},(0,n._)(this,M,e.apiService),(0,n._)(this,F,e.authenticationService)}}r(67206),r(39608);var H=r(66758);let G=new m({baseUrl:"https://dev.api.tenderwise.in/gql"}),q=new P.Ht({apiService:G}),Q=new E({uri:"https://dev.api.tenderwise.in/gql",enableCache:!0,defaultFetchPolicy:"cache-and-network",requestInterceptor:async e=>(console.log("GQL Request Interceptor:",e),e),responseInterceptor:async e=>((e.errors||[]).find(e=>{var t;return null==e||null==(t=e.message)?void 0:t.toLocaleLowerCase().includes("invalid access token")})&&(G.clearAuthToken(),window.location.reload()),e),responseErrorInterceptor:async e=>(console.error("GQL Response Error Interceptor:",e),Promise.reject(e))});new W({apiService:G,authenticationService:q});let z=new H.cs({apiService:G,authenticationService:q});new O({apiService:G,authenticationService:q})},4407:e=>{e.exports={Container:"PhoneField_Container__EtH3i",Input:"PhoneField_Input__dCT3d",Button:"PhoneField_Button__O8Eae"}},8979:(e,t,r)=>{"use strict";r.d(t,{Ht:()=>h,As:()=>_.useAuth});var a=r(94971),s=r(95920),n=r(86266),i=r(48973),o=r.n(i),l=r(19587);let c="USER_DATA";var u=new WeakMap,d=new WeakMap;class h{constructor(e){(0,s._)(this,u,{writable:!0,value:void 0}),(0,s._)(this,d,{writable:!0,value:void 0}),(0,n._)(this,d,null),this.checkUserExists=e=>{let{phoneNumberWithCountryCode:t}=e;return(0,a._)(this,u).anonPost("/auth/user_exist_check?user_id=".concat(t)).then(e=>e.data)},this.generateOtp=e=>{let{phoneNumberWithCountryCode:t}=e;return this.setUserId({userId:t}),(0,a._)(this,u).anonPost("/auth/generate_otp?user_id=".concat(t),{user_id:t}).then(e=>e.data)},this.verifyOtp=async e=>{let{otp:t,token:r}=e;return(0,a._)(this,u).anonPost("/auth/verify_otp",{otp:t,user_id:this.getUserId()},{headers:{Authorization:"Bearer ".concat(r)}}).then(e=>e.data)},this.fetchUserDetails=()=>(0,a._)(this,u).post("/users/fetch_preferences",{user_id:this.getUserId()}).then(e=>({userPreferences:(0,l.vB)({userPreferences:e.data.data}).userPreferencesSanitized,success:!0})),this.saveUserDetails=e=>{let{userPreferences:t}=e,r={...t,user_id:this.getUserId()};return(0,a._)(this,u).put("/users/update_preferences",r).then(()=>({success:!0}))},this.saveUserDetailsPartial=e=>{let{userPreferences:t}=e,r={...t,user_id:this.getUserId()||""};return r=(0,l.vB)({userPreferences:r}).userPreferencesSanitized,(0,a._)(this,u).patch("/users/update_preferences_partial",r).then(()=>({success:!0}))},this.mockFetchUserDetails=()=>{let e=null;if("undefined"!=typeof localStorage)try{e=JSON.parse(localStorage.getItem("TENDERWISE:USER_DETAILS")||"{}")}catch(t){e=null}return this.fetchUserDetails(),(0,a._)(this,u).mockCall().then(()=>({userDetails:e}))},this.mockSaveUserDetails=e=>{let{userPreferences:t}=e;return"undefined"!=typeof localStorage&&localStorage.setItem("TENDERWISE:USER_DETAILS",JSON.stringify(t)),this.saveUserDetailsPartial({userPreferences:t}),(0,a._)(this,u).mockCall().then(()=>({success:!0}))},this.setUserId=e=>{let{userId:t}=e;return"undefined"!=typeof localStorage&&localStorage.setItem(c,JSON.stringify({user_id:t})),(0,n._)(this,d,t),(0,a._)(this,d)},this.getUserId=()=>{if("undefined"!=typeof localStorage)try{let e=JSON.parse(localStorage.getItem(c)||"{}"),t=o()(e,"user_id");(0,n._)(this,d,t)}catch(e){}return(0,a._)(this,d)},this.resetUserId=()=>("undefined"!=typeof localStorage&&localStorage.removeItem(c),(0,n._)(this,d,null),(0,a._)(this,d)),(0,n._)(this,u,e.apiService),this.getUserId()}}r(90183);var _=r(29629);r(32768)},19587:(e,t,r)=>{"use strict";r.d(t,{tg:()=>d,vB:()=>u});var a=r(45009),s=r.n(a),n=r(48973),i=r.n(n),o=r(78966),l=r.n(o),c=r(93162);function u(e){let{userPreferences:t}=e,r=l()(t);["location.state","location.districts","location.town","location.locality","location.locality_village"].forEach(e=>{i()(r,e)||s()(r,e,[])});try{"string"==typeof r.keywords&&(r.keywords=JSON.parse(r.keywords)||[])}catch(e){r.keywords=[]}Array.isArray(r.emd)&&2===r.emd.length||(r.emd=[0,0]),Array.isArray(r.value)&&2===r.value.length||(r.value=[0,0]);try{if("string"==typeof r.authority_tenders_completed_count){let e=JSON.parse(r.authority_tenders_completed_count);r.authority_tenders_completed_count="number"==typeof e?String(e):"0"}}catch(e){r.authority_tenders_completed_count="0"}r.business_category||(r.business_category={}),r.product_category||(r.product_category={}),r.authority||(r.authority={});try{"string"==typeof r.metadata&&(r.metadata=JSON.parse(r.metadata)||{})}catch(e){r.metadata={}}return{userPreferencesSanitized:r}}function d(e){return c.F.some(t=>!!(e===t||e.startsWith(t+"/")))}},29545:(e,t,r)=>{"use strict";r.d(t,{default:()=>y});var a=r(95155),s=r(12115),n=r(17476),i=r(82855),o=r(65504),l=r(93162),c=r(55050),u=r(67666),d=r(35695),h=r(79510),_=r.n(h);let p=e=>{let{icon:t,label:r,link:s}=e,o=(0,d.usePathname)();return(0,a.jsxs)(n.A,{href:s,className:(0,i.t)(_().NavItem,s===o&&_().NavItemActive),children:[(0,a.jsx)(u.A,{className:_().Icon,src:t,alt:"",width:20,height:20}),(0,a.jsx)("span",{className:_().Label,children:r})]})},v=function(e){let{className:t}=e;return(0,a.jsxs)("nav",{className:(0,i.t)(t,_().Container),children:[(0,a.jsx)(p,{label:"Home",icon:"/assets/images/icons/home.svg",link:l.f.HOME_PAGE}),(0,a.jsx)(p,{label:"Search",icon:"/assets/images/icons/search.svg",link:l.f.TENDERS_PAGE}),(0,a.jsx)(p,{label:"My Tenders",icon:"/assets/images/icons/suitcase.svg",link:l.f.TENDERS_PAGE}),(0,a.jsx)(p,{label:"My Profile",icon:"/assets/images/icons/user_outline.svg",link:l.f.PROFILE_PAGE})]})};var m=r(8979),g=r(37244),f=r.n(g);let y=function(e){let{children:t,className:r,mainClassName:d,appendHeader:h,appendActionButtons:_,showNotificationAction:p=!1,showSearchAction:g=!1}=e,{isAuthenticated:y}=(0,m.As)(),w=y&&g,A=(0,s.useRef)(null),b=(0,s.useRef)(null),k=(0,s.useRef)(null),S=(0,s.useRef)(0),I=(0,s.useCallback)(e=>{console.log("DEBUG Scrolling...");let t=e.target.scrollTop;console.log("DEBUG scrollY",t,S.current),t>S.current?(A.current&&A.current.classList.add("scroll-out"),b.current&&b.current.classList.add("scroll-out")):(A.current&&A.current.classList.remove("scroll-out"),b.current&&b.current.classList.remove("scroll-out")),S.current=t},[]),x=(0,s.useCallback)(()=>(0,a.jsxs)("header",{ref:A,className:f().Header,children:[(0,a.jsx)(n.A,{href:l.f.HOME_PAGE,children:(0,a.jsx)(o.A,{})}),(0,a.jsx)(u.A,{src:"/assets/images/icons/pro_subscription_badge.svg",alt:"Pro Subscription Badge",height:24,width:24}),(0,a.jsxs)("div",{className:f().HeaderRightSection,children:[w&&(0,a.jsx)(c.A,{className:f().RoundButton,color:"gray",children:(0,a.jsx)(u.A,{src:"/assets/images/icons/search.svg",alt:"Info",height:18,width:18})}),!1,_]}),h]}),[_,h,!1,w]);return(0,s.useEffect)(()=>{},[I]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:(0,i.t)(f().Outer,r),children:(0,a.jsx)("div",{className:(0,i.t)(f().Container,"container"),children:(0,a.jsx)("main",{ref:k,className:(0,i.t)(f().Main,d),children:t})})}),(0,a.jsx)(x,{}),y&&(0,a.jsx)("div",{ref:b,children:(0,a.jsx)(v,{className:f().AppTabBar})})]})}},29629:(e,t,r)=>{"use strict";r.d(t,{g:()=>s,j:()=>i,useAuth:()=>n});var a=r(12115);let s=(0,a.createContext)({}),n=()=>(0,a.useContext)(s),i=!1},32768:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});var a=r(12115),s=r(26072),n=r(1717);let i=function(){let{data:e,isLoading:t,error:r,mutate:i}=(0,s.Ay)("/user_info/fetch",()=>n.a.fetchUserDetails(),{errorRetryCount:1,revalidateOnFocus:!1,shouldRetryOnError:!1});return{data:e,isLoading:t,error:r,update:(0,a.useCallback)(async e=>{await n.a.saveUserDetails({userPreferences:e}),i({userPreferences:e,success:!0})},[i])}}},37244:e=>{e.exports={Outer:"Layout_Outer__NjEpg",Container:"Layout_Container__8QhIo",Header:"Layout_Header__f_3V0",Main:"Layout_Main__KyruP",HeaderRightSection:"Layout_HeaderRightSection__ocSBD",RoundButton:"Layout_RoundButton__6Bjo4",AppTabBar:"Layout_AppTabBar__i6Dk4",FormContainer:"Layout_FormContainer__8ims9"}},39922:(e,t,r)=>{"use strict";r.d(t,{A:()=>a.default});var a=r(29545)},44377:(e,t,r)=>{"use strict";r.d(t,{GraphqlProvider:()=>i});var a=r(95155),s=r(43565),n=r(1717);function i(e){let{children:t}=e;return(0,a.jsx)(s.X,{client:n.qh.getClient(),children:t})}},50418:e=>{e.exports={Layout:"AuthenticationPage_Layout__7Pyd_",Main:"AuthenticationPage_Main__gll00",FormContainer:"AuthenticationPage_FormContainer__NwHe6"}},61781:e=>{e.exports={Container:"OtpField_Container__eAguj",Input:"OtpField_Input__xzhuh"}},66758:(e,t,r)=>{"use strict";r.d(t,{cs:()=>l,oC:()=>f,WS:()=>m,s_:()=>_,FX:()=>h});var a=r(94971),s=r(95920),n=r(86266),i=new WeakMap,o=new WeakMap;class l{constructor(e){(0,s._)(this,i,{writable:!0,value:void 0}),(0,s._)(this,o,{writable:!0,value:void 0}),this.fetchTendersList=e=>{let{limit:t=30,offset:r=0}=e;return(0,a._)(this,i).post("/tenders/view_all_tenders",{user_id:(0,a._)(this,o).getUserId(),limit:t,offset:r}).then(e=>({tenders:e.data}))},this.fetchTenderById=e=>{let{tenderId:t}=e;return(0,a._)(this,i).post("/tenders/single_page_view",{user_id:(0,a._)(this,o).getUserId(),tender_id:t}).then(e=>({tendersDetails:e.data}))},this.addTenderToInterestedList=e=>{let{tenderId:t}=e;return(0,a._)(this,i).post("/tenders/add_event",{user_id:(0,a._)(this,o).getUserId(),tender_id:t,event_type:"interest",event_data:{interest:"yes"}})},this.removeTenderFromInterestedList=e=>{let{tenderId:t}=e;return(0,a._)(this,i).post("/tenders/add_event",{user_id:(0,a._)(this,o).getUserId(),tender_id:t,event_type:"interest",event_data:{interest:"no"}})},this.createWorkOrder=e=>(0,a._)(this,i).post("/users/work-orders",{user_id:(0,a._)(this,o).getUserId(),...e}),this.getWorkOrderById=e=>{let{workOrderId:t}=e;return(0,a._)(this,i).post("/users/work-orders/get",{user_id:(0,a._)(this,o).getUserId(),work_order_id:t})},this.getWorkOrders=()=>(0,a._)(this,i).post("/users/work-orders/list",{user_id:(0,a._)(this,o).getUserId()}),this.updateWorkOrder=e=>(0,a._)(this,i).post("/users/work-orders/update",{user_id:(0,a._)(this,o).getUserId(),...e}),this.deleteWorkOrder=e=>{let{workOrderId:t}=e;return(0,a._)(this,i).post("/users/work-orders/delete",{user_id:(0,a._)(this,o).getUserId(),work_order_id:t})},this.calculateTenderScore=e=>{let{tenderId:t}=e;return(0,a._)(this,i).post("/tender/calculate-score",{tenderId:t}).then(e=>e.data)},(0,n._)(this,i,e.apiService),(0,n._)(this,o,e.authenticationService)}}var c=r(12115),u=r(30816),d=r(16416);let h=function(){var e,t,r;let{filters:a={limit:5}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[s]=(0,d.s)({}),n=(0,c.useMemo)(()=>({locationCityIds:s.selectedCityIds||[],authorityBodyIds:s.selectedSubAuthorityIds||[],minValue:s.minValue,maxValue:s.maxValue,minEmd:s.minEmd,maxEmd:s.maxEmd,minDistanceRadius:s.minDistanceRadius,maxDistanceRadius:s.maxDistanceRadius,limit:null==a?void 0:a.limit,page:null==a?void 0:a.page,search:null==a?void 0:a.search}),[a,s]),{data:i,error:o,loading:l,refetch:h,networkStatus:_}=(0,u.dm)({variables:{filters:n},fetchPolicy:"cache-and-network",notifyOnNetworkStatusChange:!0}),p=(null==i||null==(e=i.tenders)?void 0:e.data)||[],v=l&&!i,m=l&&!!i,g=!l&&(!i||!p.length);return{tenders:p,error:o,isLoading:v,isUpdating:m,refresh:()=>h(),noData:g,networkStatus:_,page:(null==i||null==(t=i.tenders)?void 0:t.page)||0,total:(null==i||null==(r=i.tenders)?void 0:r.total)||0}},_=function(e){let{tenderId:t}=e,{data:r,error:a,loading:s,refetch:n,networkStatus:i}=(0,u.Wb)({variables:{filters:{ids:t?[t]:[]}},skip:!t,fetchPolicy:"cache-and-network",notifyOnNetworkStatusChange:!0}),o=(null==r?void 0:r.tender)||null,l=s&&!r;return{tenderDetails:o,error:a,isLoading:l,isUpdating:s&&!!r,refresh:()=>n(),noData:!s&&!o,networkStatus:i}};var p=r(1717),v=r(26072);let m=function(e){let{tenderId:t}=e,{data:r,error:a,isLoading:s,mutate:n}=(0,v.Ay)(t?"tender-calculate-score-".concat(t):null,async()=>{if(!t)throw Error("Tender ID is required");return await p.av.calculateTenderScore({tenderId:t})},{revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateOnMount:!1,revalidateIfStale:!1,refreshInterval:0}),i=r||null;return{scoreData:i,error:a,isLoading:s,isUpdating:s&&!!r,refresh:()=>n(),noData:!s&&!i}};var g=r(93162);function f(e){let{tenderId:t}=e;return"".concat(g.f.TENDERS_PAGE,"/details?tender_id=").concat(t)}},79510:e=>{e.exports={Container:"AppTabBar_Container__2UFXP",NavItem:"AppTabBar_NavItem__abfL3",NavItemActive:"AppTabBar_NavItemActive__x0oKN",Label:"AppTabBar_Label__4bL65",Icon:"AppTabBar_Icon__Sfl98"}},83660:e=>{e.exports={Button:"AuthenticationForm_Button__v_7mk",Heading:"AuthenticationForm_Heading__D1NbZ",SubHeading:"AuthenticationForm_SubHeading__4X5o_",Label:"AuthenticationForm_Label__sbeYb",Small:"AuthenticationForm_Small__l3N8b",PhoneDisplay:"AuthenticationForm_PhoneDisplay__1BEpb",ErrorText:"AuthenticationForm_ErrorText___QNLF",ResendButton:"AuthenticationForm_ResendButton__gLM1r"}},90183:(e,t,r)=>{"use strict";r.d(t,{default:()=>M});var a=r(95155),s=r(12115),n=r(35695),i=r(1717),o=r(15616),l=r(8979),c=r(93162),u=function(e){return e.Phone="phone",e.Otp="otp",e}({}),d=r(37129),h=r(82855),_=r(39365),p=r.n(_),v=r(4407),m=r.n(v);r(30133);let g=function(e){let{className:t,value:r,onChange:n}=e,i=(0,s.useCallback)(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];n&&n(t[3])},[n]);return(0,a.jsx)(p(),{disableDropdown:!0,country:"in",containerClass:(0,h.t)(m().Container,t),inputClass:m().Input,buttonClass:m().Button,value:r,onChange:i,placeholder:"Enter Your Mobile Number",inputProps:{name:"phone",autoComplete:"phone"}})};var f=r(55050),y=r(83660),w=r.n(y),A=r(23293),b=r(61781),k=r.n(b);let S=function(e){let{className:t,value:r,onChange:n}=e,[i,o]=(0,s.useState)(""),l=void 0!==r&&void 0!==n;return(0,a.jsx)(A.A,{containerStyle:(0,h.t)(t,k().Container),value:l?r:i,onChange:l?n:o,numInputs:6,renderInput:e=>(0,a.jsx)("input",{...e,type:"number",pattern:"[0-9]*",inputMode:"numeric",className:k().Input}),placeholder:"------"})};var I=r(67666);let x=o.sf,N={phone:"",otp:""},T=d.Ik().shape({phone:d.Yj().required(),otp:d.Yj().min(6).max(6).required()}),E=[{id:u.Phone,order:1,content:(0,a.jsx)(function(){let{setFieldValue:e,values:{phone:t},stepFormRef:r,setOtpResendTime:n,setOtpError:i,setIsOtpSent:o,setVerificationId:c}=x(),{generateOtp:d,isGettingOtp:_}=(0,l.As)(),p=(0,s.useCallback)(t=>{e("phone",t),e("otp","")},[e]),v=(0,s.useCallback)(async()=>{let a=t.replaceAll(" ","").replaceAll("-","");try{let t=await d({phoneNumberWithCountryCode:a});(null==t?void 0:t.success)&&t.verificationId&&(e("otp",""),n(30),o(!0),i(null),c(t.verificationId),r.current&&r.current.gotToStep(u.Otp))}catch(e){i(e.message||"Failed to send OTP")}},[d,e,t,r,o,n,i,c]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:w().Heading,children:"Enter Whatsapp Number"}),(0,a.jsx)("div",{className:(0,h.t)("mt-2",w().SubHeading),children:"We'll have to make sure it's you."}),(0,a.jsx)("label",{className:(0,h.t)("mt-4",w().Label),children:"Mobile Number"}),(0,a.jsx)(g,{className:"w-100 mt-2",value:t,onChange:p}),(0,a.jsx)("div",{className:(0,h.t)("mt-2",w().Small),children:"We will send a verification otp on your number to verify your number."}),(0,a.jsx)(f.A,{disabled:_,onClick:v,className:(0,h.t)("w-100","mt-4 mt-md-5",w().Button),children:_?"Please wait...":"Send OTP"})]})},{})},{id:u.Otp,order:1,content:(0,a.jsx)(function(){let{isSubmittingOtp:e,values:{phone:t,otp:r},setFieldValue:n,stepFormRef:i,errors:o,submitForm:c,otpError:d,otpResendTime:_,setOtpResendTime:p,setIsOtpSent:v,setOtpError:m,setVerificationId:g}=x(),{generateOtp:y,isGettingOtp:A}=(0,l.As)(),b=!!o.otp||e;(0,s.useEffect)(()=>{if(_>0){let e=setTimeout(()=>{p(_-1)},1e3);return()=>clearTimeout(e)}},[_,p]);let k=(0,s.useCallback)(()=>{i.current&&i.current.gotToStep(u.Phone)},[i]),N=(0,s.useCallback)(async()=>{let e=t.replaceAll(" ","").replaceAll("-","");try{let t=await y({phoneNumberWithCountryCode:e});(null==t?void 0:t.success)&&t.verificationId&&(n("otp",""),p(30),v(!0),m(null),g(t.verificationId))}catch(e){m(e.message||"Failed to send OTP")}},[y,t,n,p,v,m,g]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:w().Heading,children:"Verify Your Number"}),(0,a.jsx)("div",{className:(0,h.t)("mt-2",w().SubHeading),children:"Enter the OTP sent to"}),(0,a.jsxs)("div",{className:(0,h.t)("mt-1",w().PhoneDisplay),children:[t,(0,a.jsx)(f.A,{variant:"ghost",size:"sm",onClick:k,children:(0,a.jsx)(I.A,{src:"/assets/images/icons/edit.svg",alt:"Info",height:16,width:16})})]}),(0,a.jsx)("label",{className:(0,h.t)("mt-4",w().Label),children:"OTP"}),(0,a.jsx)(S,{className:"mt-2",value:r,onChange:e=>{n("otp",e)}}),d&&(0,a.jsx)("div",{className:(0,h.t)("mt-2",w().ErrorText),children:d}),(0,a.jsx)("div",{className:(0,h.t)("mt-2",w().Small),children:_>0?"Resend OTP in ".concat(_," seconds"):(0,a.jsx)(f.A,{variant:"ghost",className:w().ResendButton,disabled:A,onClick:N,children:"Resend OTP"})}),(0,a.jsx)(f.A,{disabled:b,className:(0,h.t)("w-100","mt-4 mt-md-5",w().Button),onClick:()=>{c()},children:e?"Please wait...":"Proceed"})]})},{})}],P=function(e){let{className:t}=e,[r,i]=(0,s.useState)(!1),[d,h]=(0,s.useState)(null),[_,p]=(0,s.useState)(!1),[v,m]=(0,s.useState)(0),[g,f]=(0,s.useState)(""),y=(0,n.useRouter)(),{verifyOtp:w}=(0,l.As)(),A=(0,s.useRef)(null),b=(0,s.useCallback)(async e=>{if(r)return;i(!0);let{otp:t,phone:a}=e,s=a.replaceAll(" ","").replaceAll("-","");try{let e=await w({otp:t,phoneNumberWithCountryCode:s});e&&(h(null),e.isNewUser?y.push(c.f.WELCOME_PAGE):y.push(c.f.ONBOARDING_FORM_PAGE))}catch(e){h(e.message||"Invalid OTP. Please try again.")}finally{i(!1)}},[r,w,y]),k=(0,s.useMemo)(()=>({isSubmittingOtp:r,setIsSubmittingOtp:i,otpError:d,setOtpError:h,isOtpSent:_,setIsOtpSent:p,otpResendTime:v,setOtpResendTime:m,verificationId:g,setVerificationId:f}),[r,d,_,v,g]);return(0,a.jsx)(o.Ay,{ref:A,className:t,extraFields:k,initialValues:N,yupValidationSchema:T,onSubmit:b,initialStepId:u.Phone,steps:E})};var C=r(39922),j=r(50418),O=r.n(j);let U=function(){return(0,a.jsx)(C.A,{className:O().Layout,mainClassName:O().Main,appendHeader:!1,children:(0,a.jsx)("div",{className:(0,h.t)(O().FormContainer),children:(0,a.jsx)(P,{})})})};var R=r(30816),D=r(29629),L=r(19587),B=r(25768);let M=function(e){let{children:t}=e,r=(0,n.usePathname)(),o=(0,n.useRouter)(),[l,u]=(0,s.useState)(!1),[d,h]=(0,s.useState)(!0),[_,p]=(0,s.useState)(!0),[v,m]=(0,s.useState)(""),[g,{loading:f}]=(0,R.dZ)(),[y]=(0,R.x8)(),w=(0,L.tg)(r),A=(0,s.useCallback)(async e=>{let{phoneNumberWithCountryCode:t}=e;if(!f)try{var r,a;let e=await g({variables:{input:{phoneNumber:t,deviceId:"web-client"}}});if((null==(r=e.data)?void 0:r.generateOtp.success)&&e.data.generateOtp.verificationId)return m(e.data.generateOtp.verificationId),{success:!0,verificationId:e.data.generateOtp.verificationId,expiresInSeconds:e.data.generateOtp.expiresInSeconds};throw Error((null==(a=e.data)?void 0:a.generateOtp.message)||"Failed to generate OTP")}catch(e){throw e}},[f,g]),b=(0,s.useCallback)(async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return i.qh.clearAuthToken(),localStorage.removeItem("sessionId"),u(!1),h(!1),p(!0),m(""),e&&o.push(c.f.HOME_PAGE),{success:!0}},[o]),k=(0,s.useCallback)(async e=>{let{otp:t,phoneNumberWithCountryCode:r}=e;if(h(!0),D.j)return h(!1),u(!0),{isNewUser:!0};try{var a;let e=await y({variables:{input:{phoneNumber:r,otpCode:t,verificationId:v,deviceId:"web-client"}}});if(null==(a=e.data)?void 0:a.verifyOtp){let{accessToken:t,user:r}=e.data.verifyOtp;i.qh.setAuthToken(t),u(!0);let a=!r.firstName||"User"===r.firstName;return p(a),h(!1),{isNewUser:a}}throw Error("Verification failed")}catch(e){throw b(),h(!1),e}},[v,y,b]);(0,s.useEffect)(()=>{u(!!i.qh.getAuthToken()),h(!1)},[]);let S=(0,s.useMemo)(()=>({isAuthenticated:l,isAuthenticating:d,isGettingOtp:f,generateOtp:A,verifyOtp:k,isNewUser:_,logout:b}),[l,d,f,A,k,_,b]),I=(d||!l)&&!w;return d?(0,a.jsx)(B.A,{}):(0,a.jsx)(D.g.Provider,{value:S,children:I?(0,a.jsx)(U,{}):t})}}}]);